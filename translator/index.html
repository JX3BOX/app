<!DOCTYPE html><html lang=zh-CN><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=renderer content=webkit><title>簡繁轉換 - JX3BOX</title><link rel=icon href=https://console.cnyixun.com/static/app/favicon.ico><link href=https://console.cnyixun.com/static/app/css/chunk-common.04da9dbb.css rel=preload as=style><link href=https://console.cnyixun.com/static/app/css/chunk-vendors.8110abd9.css rel=preload as=style><link href=https://console.cnyixun.com/static/app/css/translator.45e31d0f.css rel=preload as=style><link href=https://console.cnyixun.com/static/app/js/chunk-common.84b064fd.js rel=preload as=script><link href=https://console.cnyixun.com/static/app/js/chunk-vendors.a942ee00.js rel=preload as=script><link href=https://console.cnyixun.com/static/app/js/translator.929fee21.js rel=preload as=script><link href=https://console.cnyixun.com/static/app/css/chunk-vendors.8110abd9.css rel=stylesheet><link href=https://console.cnyixun.com/static/app/css/chunk-common.04da9dbb.css rel=stylesheet><link href=https://console.cnyixun.com/static/app/css/translator.45e31d0f.css rel=stylesheet></head><body><div id=app></div><script type=app/worker id=worker>self.addEventListener("message", (event) => {
                let data = event.data;
                let cmd = data.cmd;
                let dict = data.dict;
                switch (cmd) {
                    case "translate-str":
                        postResult(tr2j3(cn2tr(data.str, dict), dict), "str");
                        break;
                    case "translate-file":
                        let reader = new FileReaderSync();
                        let preText = reader.readAsText(data.file, "gbk");
                        let jx3str = tr2j3(cn2tr(preText, dict), dict);
                        // 创建文件
                        let blob = new Blob([jx3str]);
                        postResult(blob, "file");
                        break;
                    default:
                        break;
                }
            });

            function postResult(result, type) {
                self.postMessage({ success: true, type: type, result: result });
            }

            //标准简体->台湾正体
            function cn2tr(str, dict) {
                let arr = new Array(str.length);
                let i = -1;
                let currentIndexInStr = 0;
                // 进度条
                let progress = 0;
                let lastProgress = 0;

                for (let char of str) {
                    i = dict["zh-cn"].indexOf(char);
                    i > -1 ? arr.push(dict["zh-tr"][i]) : arr.push(char);
                    currentIndexInStr += 1;
                    progress =
                        Math.floor(
                            (((currentIndexInStr / str.length) * 99.5) / 100) *
                                10000
                        ) / 100;
                    if (progress >= Math.floor(lastProgress) + 1) {
                        lastProgress = progress;
                        postResult(
                            Math.round(progress * 100) / 100,
                            "progress"
                        );
                    }
                }
                return arr.join("");
            }

            //台湾正体->剑三词汇
            function tr2j3(str, dict) {
                let x = -1; //匹配位置
                let progress = 0;
                let lastProgress = 99.5;
                let dictLength = dict["jx3box-cn"].length;
                let currentIndexInDict = 0;
                dict["jx3box-cn"].forEach((word, i) => {
                    x = str.indexOf(word);
                    if (x > -1) {
                        let re = new RegExp(word, "g");
                        str = str.replace(re, dict["jx3box-tr"][i]);
                    } else {
                    }
                    currentIndexInDict += 1;
                    progress =
                        Math.floor(
                            (((currentIndexInDict / dictLength) * 0.5) / 100) *
                                10000
                        ) /
                            100 +
                        50;
                    if (progress >= Math.floor(lastProgress) + 1) {
                        lastProgress = progress;
                        postResult(
                            Math.round(progress * 100) / 100,
                            "progress"
                        );
                    }
                });
                return str;
            }</script><div style=display:none;><script src="https://s9.cnzz.com/z_stat.php?id=1277938200&web_id=1277938200"></script><script defer data-ad-client=ca-pub-4388499329141185 src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script defer src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div><script src=https://console.cnyixun.com/static/app/js/chunk-vendors.a942ee00.js></script><script src=https://console.cnyixun.com/static/app/js/chunk-common.84b064fd.js></script><script src=https://console.cnyixun.com/static/app/js/translator.929fee21.js></script></body></html>