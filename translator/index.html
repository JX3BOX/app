<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="renderer" content="webkit"><title>簡繁轉換 - JX3BOX</title><link rel="icon" href="https://console.cnyixun.com/static/app/favicon.ico"><link href="https://console.cnyixun.com/static/app/css/chunk-common.bddd3c35.css" rel="preload" as="style"><link href="https://console.cnyixun.com/static/app/css/chunk-vendors.529beb2f.css" rel="preload" as="style"><link href="https://console.cnyixun.com/static/app/css/translator.393cd1d3.css" rel="preload" as="style"><link href="https://console.cnyixun.com/static/app/js/chunk-common.fa4bf740.js" rel="preload" as="script"><link href="https://console.cnyixun.com/static/app/js/chunk-vendors.43d20092.js" rel="preload" as="script"><link href="https://console.cnyixun.com/static/app/js/translator.6ac7460c.js" rel="preload" as="script"><link href="https://console.cnyixun.com/static/app/css/chunk-vendors.529beb2f.css" rel="stylesheet"><link href="https://console.cnyixun.com/static/app/css/chunk-common.bddd3c35.css" rel="stylesheet"><link href="https://console.cnyixun.com/static/app/css/translator.393cd1d3.css" rel="stylesheet"></head><body><div id="app"></div><script type="app/worker" id="worker">self.addEventListener("message", (event) => {
                let data = event.data;
                let cmd = data.cmd;
                let dict = data.dict;
                let encoding = data.encoding;
                switch (cmd) {
                    case "translate-str":
                        postResult(tr2j3(cn2tr(data.str, dict), dict), "str");
                        break;
                    case "translate-file":
                        let reader = new FileReaderSync();
                        let preText = reader.readAsText(data.file, encoding);
                        let jx3str = tr2j3(cn2tr(preText, dict), dict);
                        // 创建文件
                        let blob = new Blob([jx3str]);
                        postResult(blob, "file");
                        break;
                    default:
                        break;
                }
            });

            function postResult(result, type) {
                self.postMessage({ success: true, type: type, result: result });
            }

            //标准简体->台湾正体
            function cn2tr(str, dict) {
                let arr = new Array(str.length);
                let i = -1;
                let currentIndexInStr = 0;
                // 进度条
                let progress = 0;
                let lastProgress = 0;

                for (let char of str) {
                    i = dict["cn"].indexOf(char);
                    i > -1 ? arr.push(dict["tr"][i]) : arr.push(char);
                    currentIndexInStr += 1;
                    progress =
                        Math.floor(
                            (((currentIndexInStr / str.length) * 99.5) / 100) *
                                10000
                        ) / 100;
                    if (progress >= Math.floor(lastProgress) + 1) {
                        lastProgress = progress;
                        postResult(
                            Math.round(progress * 100) / 100,
                            "progress"
                        );
                    }
                }
                return arr.join("");
            }

            //台湾正体->剑三词汇
            function tr2j3(str, dict) {
                let x = -1; //匹配位置
                let progress = 0;
                let lastProgress = 99.5;
                let dictLength = dict["jx3cn"].length;
                let currentIndexInDict = 0;
                dict["jx3cn"].forEach((word, i) => {
                    x = str.indexOf(word);
                    if (x > -1) {
                        let re = new RegExp(word, "g");
                        str = str.replace(re, dict["jx3tr"][i]);
                    } else {
                    }
                    currentIndexInDict += 1;
                    progress =
                        Math.floor(
                            (((currentIndexInDict / dictLength) * 0.5) / 100) *
                                10000
                        ) /
                            100 +
                        50;
                    if (progress >= Math.floor(lastProgress) + 1) {
                        lastProgress = progress;
                        postResult(
                            Math.round(progress * 100) / 100,
                            "progress"
                        );
                    }
                });
                return str;
            }</script><div id="c-ie-tips" style="display:none;background-color: #fef0f0;color: #f56c6c;padding:10px;font-weight:bold;text-align:center;width:60%;margin:200px auto;"><p>你的浏览器版本太低，可能无法正常使用本站，建议下载<a href="https://www.google.cn/intl/zh-CN/chrome/" target="_blank">Chrome</a>或其它极速浏览器</p><p>www.jx3box.com</p></div><script>let ua = window.navigator.userAgent.toLocaleLowerCase();
            let isIE = ua.indexOf("trident") > 0 || ua.indexOf("msie") > 0;
            if (isIE) document.getElementById("c-ie-tips").style.display = "block";</script><div style="display:none;"><script src="https://s9.cnzz.com/z_stat.php?id=1277938200&web_id=1277938200"></script></div><script src="https://console.cnyixun.com/static/app/js/chunk-vendors.43d20092.js"></script><script src="https://console.cnyixun.com/static/app/js/chunk-common.fa4bf740.js"></script><script src="https://console.cnyixun.com/static/app/js/translator.6ac7460c.js"></script></body></html>