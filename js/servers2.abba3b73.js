(function(e){function t(t){for(var a,i,l=t[0],c=t[1],o=t[2],v=0,f=[];v<l.length;v++)i=l[v],Object.prototype.hasOwnProperty.call(s,i)&&s[i]&&f.push(s[i][0]),s[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(t);while(f.length)f.shift()();return n.push.apply(n,o||[]),r()}function r(){for(var e,t=0;t<n.length;t++){for(var r=n[t],a=!0,l=1;l<r.length;l++){var c=r[l];0!==s[c]&&(a=!1)}a&&(n.splice(t--,1),e=i(i.s=r[0]))}return e}var a={},s={servers2:0},n=[];function i(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=a,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(r,a,function(t){return e[t]}.bind(null,a));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="https://cdn.jx3box.com/static/app/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=t,l=l.slice();for(var o=0;o<l.length;o++)t(l[o]);var u=c;n.push([9,"chunk-vendors","chunk-common"]),r()})({"34fd":function(e,t,r){},9:function(e,t,r){e.exports=r("a334")},"9e67":function(e,t,r){},a334:function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),s=r("5c96"),n=r.n(s),i=r("6a69"),l=(r("6b30"),r("c5b4"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"p-app-servers",attrs:{id:"app"}},[t("Header"),t("Breadcrumb",{staticClass:"m-app-servers-bread",attrs:{name:"开服监控",slug:"servers",root:"/app/servers",feedbackEnable:!0,crumbEnable:!0}},[t("img",{staticClass:"u-app-servers",attrs:{slot:"logo","svg-inline":"",src:e.getIcon("servers")},slot:"logo"})]),t("LeftSidebar",{attrs:{open:!1}},[t("Nav")],1),t("Main",{attrs:{withoutRight:!0,withoutLeft:!0}},[t("div",{staticClass:"m-app-servers"},[t("h1",{staticClass:"m-app-servers-title"},[e._v("剑三服务器实时监控面板")]),t("div",{staticClass:"searchbar-wrapper"},[t("el-input",{staticClass:"input-with-select",attrs:{placeholder:"搜索全部服务器"},model:{value:e.searchServerName,callback:function(t){e.searchServerName=t},expression:"searchServerName"}},[t("template",{slot:"prepend"},[e._v("服务器名")]),[t("i",{staticClass:"el-icon-search",attrs:{slot:"append"},slot:"append"})]],2)],1),t("div",{staticClass:"serverbox"},[t("el-collapse",{model:{value:e.showCollapse,callback:function(t){e.showCollapse=t},expression:"showCollapse"}},[e.favList.length?t("el-collapse-item",{attrs:{title:"收藏",name:1}},[t("div",{staticClass:"serverbox-list"},e._l(e.favList,(function(r,a){return t("div",{key:a,staticClass:"serverbox-item"},[t("server-card",{attrs:{data:r,favList:e.favList},on:{clickServer:e.clickServer}})],1)})),0)]):e._e(),e.list.length?t("div",e._l(e.list,(function(r,a){return t("el-collapse-item",{key:a,attrs:{title:r.zone_name,name:a+2}},[r.serverArr?t("div",{staticClass:"serverbox-list"},e._l(r.serverArr,(function(r,a){return t("div",{key:a,staticClass:"serverbox-item"},[t("server-card",{attrs:{data:r,favList:e.favList},on:{clickServer:e.clickServer}})],1)})),0):[t("el-alert",{staticClass:"u-alert",attrs:{title:"没有对应的服务器",type:"info",center:"","show-icon":""}})]],2)})),1):[t("el-alert",{staticClass:"u-alert",attrs:{title:"没有对应的服务器",type:"info",center:"","show-icon":""}})]],2)],1)]),t("Footer")],1)],1)}),c=[],o=r("2909"),u=r("5530"),v=r("b85c"),f=(r("7db0"),r("d3b7"),r("6062"),r("3ca3"),r("ddb0"),r("14d9"),r("d81d"),r("159b"),r("caad"),r("2532"),r("a15b"),r("4de4"),r("99af"),r("216c")),d=r("c9d2"),p=(r("c7eb"),r("1da1"),r("bc3a")),h=r.n(p),m=r("65c2"),b=r("41cb"),_=h.a.create({baseURL:"https://spider2.jx3box.com/"});function C(){return Object(b["a"])().get("api/cms/user/my/meta",{params:{key:"jx3_servers"}}).then((function(e){return e.data.data}))}function S(e){return Object(b["a"])().post("api/cms/user/my/meta",{val:e},{params:{key:"jx3_servers"}}).then((function(e){return e.data.data}))}function g(){return _.get("/api/spider/server/server_state")}var y=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"m-server-card"},[t("div",{staticClass:"m-server-card__header",attrs:{slot:"header"},slot:"header"},[t("b",{staticClass:"u-title"},[e._v(e._s(e.data.main_server))]),t("el-button",{staticClass:"u-action",attrs:{plain:"",size:"mini",type:e.isSaved?"info":""},on:{click:e.favHandle}},[e._v(e._s(e.isSaved?"取消":"")+"收藏")])],1),t("div",{staticClass:"m-server-card__content"},[t("div",{staticClass:"u-item u-status"},[t("span",[e._v("当前状态:")]),t("b",{class:e.data.connect_stateClass},[e._v(e._s(e.data.connect_state_name))])]),t("div",{staticClass:"u-item u-ip"},[t("span",[e._v("IP:")]),e._v(e._s(e.data.ip_address))]),t("div",{staticClass:"u-item u-time"},[t("span",[e._v("最近维护时间:")]),e._v(e._s(e.dayjs(1e3*e.data.maintain_time).format("YYYY-MM-DD HH:mm:ss")))])])])},w=[],x=r("5a0c"),j=r.n(x),A={props:["data","favList"],computed:{isSaved:function(){var e=this;return this.favList.filter((function(t){return-1!==t.main_server.indexOf(e.data.main_server)})).length>0}},methods:{dayjs:j.a,favHandle:function(){this.$emit("clickServer",this.data)}}},O=A,k=(r("f8f9"),r("2877")),L=Object(k["a"])(O,y,w,!1,null,null,null),I=L.exports,N={name:"Servers2",data:function(){return{searchServerName:"",serverData:{},searchData:{},serverAllList:[],serverAllArr:[],favList:[],serverArr:[],searchArr:[],showCollapse:[2],heatStateArr:[{value:"6",label:"良好",class:"isOpen"},{value:"7",label:"繁忙",class:"isBusy"},{value:"8",label:"爆满",class:"isFullLoad"},{value:"3",label:"维护中",class:"isClose"}]}},computed:{list:function(){return this.searchServerName?this.searchArr:this.serverArr},uid:function(){return d["a"].getInfo().uid||0},findValue:function(){return function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"value",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"label",s=e.find((function(e){return e[r]==t}));return s?s[a]:""}}},methods:{getIcon:function(e){return m["__imgPath"]+"image/box/"+e+".svg"},clickServer:function(e){var t=new Set(this.favList),r=[];t.has(e)?t.delete(e):t.add(e);var a,s=Object(v["a"])(t.keys());try{for(s.s();!(a=s.n()).done;){var n=a.value;r.push(n)}}catch(i){s.e(i)}finally{s.f()}this.favList=r,this.showCollapse=this.setCollapseIndex(1),this.setSavedServers()},loadAllServers:function(){var e=this;g().then((function(t){e.serverAllArr=t.data.map((function(t){return Object(u["a"])(Object(u["a"])({},t),{},{connect_state_name:e.findValue(e.heatStateArr,t.heat),connect_stateClass:e.findValue(e.heatStateArr,t.heat,"value","class")})})),e.serverArr=e.setItemData(e.serverAllArr),e.serverArr.forEach((function(t,r){e.showCollapse=e.setCollapseIndex(r+2)})),e.uid&&C().then((function(t){e.serverFav(t)}))}))},serverFav:function(e){var t=this;e&&(e=e.split(","),this.serverAllArr.forEach((function(r){e.includes(r.main_server)&&t.favList.push(r)})),this.showCollapse=this.setCollapseIndex(1))},setSavedServers:function(){if(!this.uid)return d["a"].toLogin();var e=this.favList.map((function(e){return e.main_server}));S(e.join(",")).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))},searchServer:function(e){var t=this;if(e){var r=this.setItemData(this.serverAllArr.filter((function(t){return-1!==t.main_server.indexOf(e)})));this.searchArr=r,r.forEach((function(e,r){t.showCollapse=t.setCollapseIndex(r+2)}))}},setItemData:function(e){if(!e.length)return[];var t=Object(o["a"])(new Set(e.map((function(e){return e.zone_name}))));return t.map((function(t){return{zone_name:t,serverArr:e.filter((function(e){return e.zone_name===t}))}}))},setCollapseIndex:function(e){return Object(o["a"])(new Set([].concat(Object(o["a"])(this.showCollapse),[e]).map((function(e){return e}))))}},filters:{serverName:function(e){var t={search:"搜索结果",server:"重制",old:"缘起"};return t[e]}},created:function(){this.loadAllServers()},components:{Nav:f["a"],serverCard:I},watch:{searchServerName:function(e){this.searchServer(e)}}},P=N,D=(r("bedf"),Object(k["a"])(P,l,c,!1,null,null,null)),M=D.exports;a["default"].config.productionTip=!1,a["default"].use(n.a),a["default"].use(i["a"]),new a["default"]({render:function(e){return e(M)}}).$mount("#app")},bedf:function(e,t,r){"use strict";r("34fd")},f8f9:function(e,t,r){"use strict";r("9e67")}});
//# sourceMappingURL=servers2.abba3b73.js.map